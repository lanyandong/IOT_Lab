### 单片机概念

单片机：Micro controller，MCU，微控制器，是一种集成电路芯片，它通过超大规模集成电路技术把具有数据处理能力的中央处理器CPU、随机存储器RAM、只读存储器ROM、输入输出I/O端口、中断控制系统、定时/计数器和通信接口等多种功能部件集成到一块硅片上，构成了一个体积小但功能完善的微型计算机系统。

### CC2530 MCU 与IAR

CC2530微控制器内部使用业界标准的增强型8051内核，结合了领先的RF收发器，是用于2.4GHz IEEE802.15.4的Zigbee应用的一个片上系统(SOC)解决方案。

整个CC2530开发相关的环境包括：

​        1.安装集成开发环境：IAR-EW8051-8101。

​        2.安装仿真器“SmartRF4EB”的驱动程序。

​        3.安装代码烧写工具：Setup_SmartRF_Programmer_1.10.2。

​        4.安装TI的Zigbee协议栈：ZStack-CC2530-2.5.1a。



### CC2530 基础功能模块

**1、CC2530通用I/O端口寄存器**

​	**PxSEL**：端口功能选择，设置端口是**通用I/O**还是**外设功能**。 

​	**PxDIR**：作为通用I/O时，用来设置数据的传输方向。

​	**PxINP**：作为通用输入端口时，选择输入模式是**上拉**、**下拉**还是**三态**。 

​	**Px**：数据端口，用来控制端口的输出或获取端口的输入。



**2、中断相关基础概念**

​	内核与外设之间的主要交互方式有两种：**轮询**和**中断**。

两个重要的概念：

​        **中断服务函数**： 内核响应中断后执行的相应处理程序。

​        **中断向量**：中断服务程序的入口地址。每个中断源都对应一个固定的入口地址。当内核响应中断请求时，就会暂停当前的程序执行，然后跳转到该入口地址执行代码。

中断有优先级，低优先级不能中断高优先级的，中断不能中断自己。


EA 管理所有中断使能，有中断为1

中断标志(寻找中断标志)，自动置1，结束需要清0。硬件清0，建议软件清0

PICTL：中断触发方式（0上升沿或者1下降沿触发）

中断函数编写：中断向量（中断的入口） + 中断服务程序

```c
#pragma vector = P1INT_VECTOR
__interrupt void P1()
{
    /*****************
        //代码
    *****************/
}
```



**3、定时计数器**

定时/计数器，是一种能够对内部时钟信号或外部输入信号进行计数，当计数值达到设定要求时，向CPU提出**中断**处理请求，从而实现定时或者计数功能的外设。

定时/计数器的最基本工作原理是进行计数。不管是定时器还是计数器，本质上都是计数器，可以进行加1（减1）计数，每出现一个计数信号，计数器就会自动加1（自动减1），当计数值从0变成最大值（或从最大值变成0）溢出时，定时/计数器就会向CPU提出中断请求。



**4、串口通信**

**并行通信**：指数据的各位同时发送或接收，每个数据位使用单独的一条导线。传输速度快、效率高，但需要的数据线较多，成本高。 

**串行通信**：指数据一位接一位地顺 序发送或接收。需要的数据线少，成本低，但传输速度慢，效率低。

CC2530 USART串口通信编程，本质是设置相关的5个寄存器：

​        <1> **UxCSR**：   USARTx的控制和状态寄存器。

​        <2> **UxUCR**：  USARTx的UART控制寄存器。

​        <3> **UxGCR**：  USARTx的通用控制寄存器。

​        <4> **UxDBUF**：USARTx的接收/发送数据缓冲寄存器。

​        <5> **UxBAUD**：USARTx的波特率控制寄存器。

**UART口与计算机的COM口连接**

​        TTL电平和RS232电平

​        TTL电平：       逻辑0----小于0.8V     逻辑1----大于2.4V

​        RS232电平：  逻辑0----5~15V         逻辑1---- -5~-15V

计算机的串行通信接口是RS-232的标准接口，而CC2530单片机的UART接口则是TTL电平，两者的电气规范不一致，所以要完成两者之间的数据通信，就需要借助接口芯片在两者之间进行电平转换，常用的有MAX232芯片。



**5、A/D装换**

将时间上连续变化的模拟量转化为脉冲有无的数字量，这一过程就叫做数字化，实现数字化的关键设备是**ADC**。

​	CC2530 ADC模块有如下主要特征：

​        <1> 可选取的抽取率，设置分辨率（7~12位）。

​        <2> 8个独立的输入通道，可接收单端或差分信号。

​        <3> 参考电压可选为内部单端、外部单端、外部差分或AVDD5。

​        <4> 单通道转换结束可产生中断请求。

​        <5> 序列转换结束可发出DMA触发。

​        <6> 可将片内温度传感器作为输入。

​        <7> 电池电压测量功能。

